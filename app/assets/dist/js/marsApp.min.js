"use strict";var app=angular.module("app",["720kb.tooltips","angucomplete-alt","ui.bootstrap","ngStorage"]);app.config(["$httpProvider","$compileProvider","$locationProvider",function(e,t,o){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.Pragma="no-cache",o.html5Mode({enabled:!0,requireBase:!1}),o.html5Mode(!0)}]),angular.module("app").run(["$templateCache",function(e){e.put("templateCache/custom-datepicker.tmpl.html",'<div class="custom-datepicker custom-cal controls mars-form-control form-control width-full" ng-click="open($event)" tabindex="{{tabindex}}" ng-class="{\'disabled\': isDisabled}"><i class="glyphicon glyphicon-calendar fa fa-calendar"></i><input type="text" class="form-control" uib-datepicker-popup="{{format}}" readonly="readonly" ng-model="dt" is-open="status.opened" show-button-bar="{{!hideButtonBar}}" datepicker-append-to-body="true" datepicker-options="dateOptions"><b class="caret"></b></div>'),e.put("templateCache/datagrid-view.tmpl.html",'<div class="datagrid-view"><div class="dataTables_wrapper"><table class="table nowrap inner-dataTable dataTable nofooter" id="{{tableId}}"><thead><th ng-repeat="col in tableColumns track by col.attrId" ng-click="sort(col)" id="{{tableId + \'__\' + col.attrId}}" ng-if="col.isFirstRow"><span>{{col.name}}</span>&nbsp;<i class="sort-icon fa" ng-class="{\r\n                            \'fa-sort-asc\': gridState.order.column && gridState.order.column.attrId == col.attrId && gridState.order.asc, \r\n                            \'fa-sort-desc\': gridState.order.column && gridState.order.column.attrId == col.attrId && !gridState.order.asc}" ng-if="col.attrId != $scope.controlChildRowId"></i></th></thead><tbody ng-hide="gridState.isFiltering || !gridState.records || gridState.records.length == 0"><tr ng-repeat-start="record in gridState.records track by record.id"><td ng-repeat="field in tableColumns track by field.attrId" ng-if="field.isFirstRow" ng-include="\'row_renderer.html\'"></td></tr><tr ng-repeat-end ng-if="rowState[record.id].showingChildRow" ng-class="{\'highlight-row\': record.statusCode == \'E\'}"><td colspan="{{firstRowLength + 2}}"><div style="margin-left: 25px"><table class="width-full"><thead><tr><th ng-repeat="col in secondRowCols track by col.attrId"><span>{{col.name}}</span></th></tr></thead><tbody><tr><td ng-repeat="field in secondRowCols track by field.attrId" ng-include="\'row_renderer.html\'"></td></tr></tbody></table></div></td></tr></tbody><tbody class="ng-hide" ng-show="!gridState.isFiltering && (!gridState.records || gridState.records.length == 0)"><tr class="odd"><td valign="top" colspan="{{tableColumns.length}}" class="dataTables_empty">No data available in table.</td></tr></tbody><tbody class="ng-hide" ng-show="gridState.isFiltering"><tr class="odd"><td valign="top" colspan="{{tableColumns.length}}" class="dataTables_empty"><b>LOADING...</b></td></tr></tbody></table><div class="dataTables_length"><label><select class="form-control input-sm" ng-model="gridState.pageSize" ng-change="refreshData()" ng-if="tableOptions.showPageSize"><option value="10">10</option><option value="25">20</option><option value="50">50</option><option value="100">100</option></select></label></div><div class="dataTables_paginate paging_full_numbers"><ul class="pagination" uib-pagination total-items="gridState.totalRecords" items-per-page="gridState.pageSize" ng-model="gridState.pageIndex" ng-if="tableOptions.paging" ng-change="refreshData()" boundary-link-numbers="true" rotate="true" max-size="5"></ul></div></div><script type="text/ng-template" id="row_renderer.html"><div ng-if="field.attrId != controlChildRowId">\r\n             {{record[field.attrId]}}\r\n        </div> \r\n        <div ng-if="field.attrId == controlChildRowId" class="mars-tooltip" title="Control">\r\n            <a ng-click="showChildRow(record)" style="color: #2a5c0b; font-size: 16px;">\r\n                <i class="fa" \r\n                    ng-class="{\'fa-plus-circle\' : !rowState[record.id].showingChildRow, \'fa-minus-circle\' : rowState[record.id].showingChildRow }"></i>\r\n            </a>\r\n        </div><\/script></div>'),e.put("templateCache/loading.tmpl.html",'<div id="preloader"><div class="loader"><span></span><span></span><span></span><span></span></div></div>'),e.put("templateCache/search-box.tmpl.html",'<div class="search-box-wrapper"><div class="angucomplete-wrapper"><angucomplete-alt id="ex1" placeholder="Search column" pause="100" selected-object="selectedAttribute" local-data="tableColumns" search-fields="name" title-field="name" minlength="2" input-class="form-control form-control-small mars-tooltip" clear-selected="true" focus-out="focusOut()" input-changed="inputChanged" ng-show="!selectedAttribute"></div><div ng-show="selectedAttribute" class="input-group"><div id="attrTab" class="attrTab input-group-addon">{{selectedAttribute.title}}<a ng-click="clearSearch();" style="cursor: pointer;color: #555">&nbsp;<i class="fa fa-remove"></i></a></div><input id="attrVal" type="text" ng-model="selectedValue" class="form-control attrVal" tabindex="0/"></div></div>'),e.put("templateCache/section-filter.tmpl.html",'<div class="mars-accordion-section" id="section-filter"><div ng-click="toggleHeading($event)" data-target="#section-filter-content" class="row mars-accordion-header"><div class="col-sm-4 col-md-6"><h3><i ng-hide="collapse" class="fa fa-angle-down"></i><i ng-show="collapse" class="fa fa-angle-right"></i>Search for Commodities</h3></div></div><div id="section-filter-content" class="mars-accordion-content clearfix"><div class="col-sm-4"><b>Commodities</b><p>Type</p><select name="commodityType" chosen search-contains="true" placeholder-text-single="\'Select type\'" ng-model="filter.commodityType" class="form-control"><option ng-repeat="commodityType in commodityTypes track by $index" value="{{commodityType}}">{{commodityType}}</option></select><div ng-show="filter.commodityType == \'Commodity\'"><p>Commodity</p><select name="commodity" chosen search-contains="true" placeholder-text-single="\'Select commodity\'" ng-model="filter.commodity" class="form-control"><option ng-repeat="commodity in commodities track by $index" value="{{commodity.commodity}}">{{commodity.commodity}}</option></select></div><div ng-show="filter.commodityType == \'Office\'"><p>Office</p><select name="office" chosen search-contains="true" placeholder-text-single="\'Select office\'" ng-model="filter.office" class="form-control"><option ng-repeat="office in offices track by $index" value="{{office.office_name}}">{{office.office_name}}</option></select></div><div ng-show="filter.commodityType == \'Report\'"><p>Report</p><select name="report" chosen search-contains="true" placeholder-text-single="\'Select report\'" ng-model="filter.report" class="form-control"><option ng-repeat="report in reports track by $index" value="{{report.report_name}}">{{report.report_name}}</option></select></div></div><div class="col-sm-4"><b>Location</b><p>Select State</p><select name="state" chosen search-contains="true" placeholder-text-single="\'Select state\'" ng-model="filter.state" class="form-control"><option value="">Select state</option><option ng-repeat="state in states track by $index" value="{{state.name}}">{{state.name}}</option></select></div><div class="col-sm-4"><b>Time</b><p>Select From Date</p><custom-datepicker date-model="filter.reportFromDate" date-object="true" max-date="reportMaxDate"></custom-datepicker><p>Select To Date</p><custom-datepicker date-model="filter.reportToDate" date-object="true" max-date="reportMaxDate"></custom-datepicker><p>Select period</p><select name="period" chosen search-contains="true" placeholder-text-single="\'Select period\'" ng-model="filter.period" class="form-control"><option value="">Select period</option><option ng-repeat="period in periods track by $index" value="{{period.name}}">{{period.name}}</option></select></div><div class="col-sm-12 action-bar"><div class="col-sm-8 pull-left" style="color: red"><p ng-repeat="errMsg in errMessages track by $index">{{errMsg}}</p></div><div class="col-sm-2 pull-right"><a class="btn mars-form-control form-control" ng-click="getData()">GET DATA</a></div><div class="col-sm-2 pull-right"><a class="btn mars-form-control form-control" ng-click="clearFilter()">CLEAR</a></div></div></div></div>'),e.put("templateCache/section-result.tmpl.html",'<div class="mars-accordion-section" id="section-result"><div ng-click="toggleHeading($event)" data-target="#section-result-content" class="row mars-accordion-header"><div class="col-sm-4 col-md-6"><h3><i ng-hide="collapse" class="fa fa-angle-down"></i><i ng-show="collapse" class="fa fa-angle-right"></i>Result</h3></div></div><div id="section-result-content" class="mars-accordion-content clearfix"><div ng-if="filterFields && filterFields.length > 0" class="col-sm-12"><div class="mars-accordion-section"><div ng-click="toggleHeadingFilter($event)" data-target="#section-result-filter" class="row mars-accordion-header"><div class="col-sm-4 col-md-6"><h3><i ng-hide="filterCollapse" class="fa fa-angle-down"></i><i ng-show="filterCollapse" class="fa fa-angle-right"></i>Filter result</h3></div></div><div id="section-result-filter" class="mars-accordion-content clearfix result-filter" style="display: none"><div class="col-sm-12"><div class="col-sm-3" ng-repeat="field in filterFields"><span>{{field.name}}</span><input type="text" name="{{field.name}}" ng-model="resultFilter[field.attrId]" class="form-control"></div></div><div class="col-sm-12"><div class="col-sm-2 pull-right filter-btn"><a class="btn mars-form-control form-control" ng-click="filterData()">Filter</a></div><div class="col-sm-2 pull-right"><a class="btn mars-form-control form-control" ng-click="resetFilterData()">Reset Filter</a></div></div></div></div></div><div class="col-sm-12" ng-if="!filtering && (!groupRecords || !groupRecords.length)"><p class="no-data">No data available</p></div><div class="col-sm-12 table-result" ng-if="!filtering && groupRecords && groupRecords.length"><div class="control-bar clearfix"><div class="col-sm-2"><a ng-show="!collapsed" class="btn mars-form-control form-control" ng-click="toggleCollapseAll()"><i class="fa fa-minus-circle"></i>&nbsp;&nbsp;Collapse All</a><a ng-show="collapsed" class="btn mars-form-control form-control" ng-click="toggleCollapseAll()"><i class="fa fa-plus-circle"></i>&nbsp;&nbsp;Expand All</a></div></div><div ng-repeat="group in groupRecords track by $index" class="group-records"><p class="group-key" ng-click="toggleCollapseGroup(group)"><span style="margin-right: 5px"><i ng-show="group.collapsed" class="fa fa-plus-circle"></i><i ng-show="!group.collapsed" class="fa fa-minus-circle"></i></span>{{group.key}}</p><div ng-show="!group.collapsed"><datagrid-view table-columns="group.tableColumns" table-data="group.records" table-options="tableOptions"></datagrid-view></div></div></div></div></div>')}]),app.constant("COLLECTION_FREQUENCY",{DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly",YEARLY:"yearly"}).constant("DEFAULT_SORT_COL","report_date").constant("DATE_FORMAT","MM/DD/YYYY"),app.controller("mainController",["$scope","$rootScope","DataFactory","$q","$timeout",function(e,t,o,a,r){}]),app.directive("customDatepicker",["$parse","COLLECTION_FREQUENCY","DATE_FORMAT",function(e,t,o){return{templateUrl:"templateCache/custom-datepicker.tmpl.html",scope:{dateModel:"="},link:function(a,r,i){function n(e){var o={format:"MM/dd/yyyy",yearFormat:"yy",startingDay:1,minDate:l,maxDate:e,appendToBody:!0};c==t.WEEKLY?o.dateDisabled=function(e){return"day"===e.mode&&1!=e.date.getDay()}:c==t.MONTHLY?o={format:"MMMM yyyy",formatMonth:"MMMM",formatYear:"yyyy",minMode:"month",minDate:l,maxDate:e,appendToBody:!0}:c==t.YEARLY&&(o={format:"yyyy",formatYear:"yyyy",minMode:"year",minDate:l,maxDate:e,appendToBody:!0}),a.dateOptions=o,a.format=a.dateOptions.format}var l=moment().subtract(30,"years").toDate(),c=(i.maxDate&&""!=i.maxDate&&e(i.maxDate)(a),i.collectFrequency&&""!=i.collectFrequency?e(i.collectFrequency)(a):null),s=i.dateObject&&"true"==i.dateObject;a.hideButtonBar=i.hideButtonBar&&"true"==i.hideButtonBar,a.tabindex=i.tab?i.tab:0,a.$watch(function(){return a[i.maxDate]},function(e){n(e)}),a.$watch(function(){return a.dateModel},function(e){if(e)if(s)a.dt=e;else{var t=moment(e,o);t.isValid()?a.dt=t.toDate():a.dt=null}else a.dt=null}),a.$watch(function(){return e(i.ngDisabled)(a)},function(e){a.isDisabled=e});var d=a.dateModel,p=null;d&&""!=d&&(p=s?d:moment(d,o).toDate()),null!=p?(a.dateModel=s?p:d,a.dt=p):a.dt=null,a.$watch(function(){return a.dt},function(e){var t=(e=e||null)?moment(e).format(o):null;a.dateModel=s?e:t}),a.status={opened:!1},a.open=function(e){a.status.opened=!0}}}}]),app.directive("datagridView",["$timeout","$rootScope","CommonFactory","DEFAULT_SORT_COL",function(e,t,o,a){return{restrict:"E",templateUrl:"templateCache/datagrid-view.tmpl.html",scope:{tableColumns:"=",tableData:"=",tableOptions:"=",searchControlId:"="},link:function(t,o){e(function(){o.find(".mars-tooltip:not(.tooltipstered)").tooltipster()},0,!1)},controller:["$scope",function(t){function r(o){e(function(){var e=[],a=t.tableData||[],r=parseInt(0==t.gridState.pageIndex?0:t.gridState.pageIndex-1)*parseInt(t.gridState.pageSize);r=r>0?r:0,t.gridState.order&&t.gridState.order.column&&(a=_.sortByOrder(a,function(e){var o=e[t.gridState.order.column.attrId?t.gridState.order.column.attrId:t.gridState.order.column];return o?o.label?o.label:o:null},t.gridState.order.asc)),t.tableOptions.searching&&t.gridState.search&&t.gridState.search.length>0&&_.forEach(t.gridState.search,function(e){a=e.column?_.filter(a,function(t){var o=t[e.column.attrId];return(o=o?o.id?o.label:o:null)&&(o+"").toLowerCase().indexOf(e.text.toLowerCase())>=0}):_.filter(a,function(t){for(var o in t.customObject)if(t.customObject.hasOwnProperty(o)){var a=t.customObject[o].label;if(a&&(a+"").toLowerCase().indexOf(e.text.toLowerCase())>=0)return!0}return!1})});var i=r+parseInt(t.gridState.pageSize);_.forEach(a,function(t,o){o>=r&&o<i&&e.push(t)}),t.gridState.totalRecords=a?a.length:0,t.gridState.records=e,t.gridState.isFiltering=!1,o&&c()})}function i(e){t.gridState.search=[],_.forEach(e,function(e){t.gridState.search.push({column:_.find(t.tableColumns,{attrId:e.attrId}),text:e.searchValue})}),r(!0)}function n(e){return e.attrId!=t.controlChildRowId}function l(){_.forEach(t.tableColumns,function(e,o){e.attrId!=t.controlChildRowId?e.isFirstRow=!0:e.isFirstRow=!1})}function c(){l(),e(function(){var e=$("#"+t.tableId),o=t.tableOptions.wrapperClass?t.tableOptions.wrapperClass:"dataTables_wrapper",a=e.closest("."+o).width();if(a){var r=0,i=[],n=-1;if(_.forEach(t.tableColumns,function(e,o){var l=t.tableId+"__"+e.attrId;r<=a?(r+=$("#"+l).outerWidth(),n=o):(i.push(angular.copy(e)),e.isFirstRow=!1)}),r>a&&!i.length&&(n=t.tableColumns.length-1),n>=0&&r>a)for(;r+30>a;){var l=t.tableColumns[n],c=t.tableId+"__"+l.attrId;r-=$("#"+c).outerWidth(),l.isFirstRow=!1,i.unshift(angular.copy(l)),n--}t.secondRowCols=i,console.log("secondRowCols",t.tableId,i),t.firstRowLength=_.countBy(t.tableColumns,function(e){return e.isFirstRow})[!0];var s=_.find(t.tableColumns,{attrId:t.controlChildRowId});s&&(t.secondRowCols.length>0?s.isFirstRow=!0:s.isFirstRow=!1)}})}t.tableOptions.pageSize+="",t.rowState={},t.gridState={records:[],search:[],order:{column:{attrId:a},asc:!1},pageSize:t.tableOptions.pageSize,pageIndex:t.tableOptions.pageIndex,totalRecords:t.tableData?t.tableData.length:0,isFiltering:!0},t.tableId=o.generateUUID(),t.refreshData=r,t.searchCallBack=i,t.searchReset=function(){t.gridState.search=[],r(!0)},t.sort=function(e){n(e)&&(t.gridState.order.column||(t.gridState.order.column={}),t.gridState.order.asc=t.gridState.order.column.attrId!=e.attrId||!t.gridState.order.asc,t.gridState.order.column=e,r(!0))},t.showChildRow=function(e){var o=e.id;void 0===t.rowState[o]?t.rowState[o]={showingChildRow:!0}:t.rowState[o].showingChildRow=!t.rowState[o].showingChildRow},t.controlChildRowId="column-controlled-child-rows";t.tableOptions.searching&&t.$on("datagrid.search",function(e,t){i(t)}),l(),r(!0);var s=$(window).width();$(window).resize(function(){var e=$(window).width();s!=e&&(s=e,c())})}]}}]),app.directive("loading",["$http",function(e){return{restrict:"E",templateUrl:"templateCache/loading.tmpl.html",link:function(t,o,a){t.isLoading=function(){return!!e.pendingRequests.length&&!_.find(e.pendingRequests,{hideLoading:!0})},t.$watch(t.isLoading,function(e){e?o.show():o.hide()})}}}]),app.directive("backTop",function(){return{restrict:"E",replace:!0,template:'<div class="back-to-top"><i class="fa fa-chevron-up"></i></div>',link:function(e,t,o){$(window).scroll(function(){$(window).scrollTop()<=0?$(t).fadeOut():$(t).fadeIn()}),$(t).on("click",function(){$("html, body").animate({scrollTop:0},"fast")})}}}),app.directive("dcSearchBox",["CommonFactory","$timeout",function(e,t){return{replace:!0,templateUrl:"templateCache/search-box.tmpl.html",restrict:"E",scope:{tableColumns:"=",searchSubmit:"&",clearSearchCallBack:"&"},link:function(e,o,a){e.searchValue=null,e.clearSearch=function(){e.selectedAttribute=void 0,e.selectedValue=void 0,e.clearSearchCallBack({})},e.focusOut=function(){o.find("#attrVal").focus()},e.inputChanged=function(t){e.searchValue=t},o.find("#attrVal").bind("keydown keypress",function(t){13===t.which&&(e.searchSubmit({$attrId:e.selectedAttribute.originalObject.attrId,$searchValue:e.selectedValue}),t.preventDefault())}),o.find(".angucomplete-wrapper").bind("keydown keypress",function(o){t(function(){13!==o.which||e.selectedAttribute||(e.searchSubmit({$attrId:null,$searchValue:e.searchValue}),o.preventDefault())},500)})}}}]),app.directive("sectionFilter",["$parse","DataFactory","$q","$timeout","$rootScope",function(e,t,o,a,r){return{restrict:"E",replace:!0,templateUrl:"templateCache/section-filter.tmpl.html",scope:{dataModel:"="},link:function(e,i,n){function l(){var t=[];return"Commodity"!=e.filter.commodityType||e.filter.commodity?"Office"!=e.filter.commodityType||e.filter.office?"Report"!=e.filter.commodityType||e.filter.report||t.push("Report is required."):t.push("Office is required."):t.push("Commodity is required."),e.filter.reportFromDate>e.filter.reportToDate&&t.push("Report From Date must be before the Report To Date."),e.errMessages=t,!t.length}e.toggleHeading=function(t){e.collapse=!e.collapse;var o=$($(t.currentTarget).data("target"));e.collapse?o.slideUp(300):o.slideDown(300)},e.commodityTypes=["Commodity","Office","Report"],e.states=[],e.periods=[{value:0,name:"Annual"}],e.filter={commodityType:"Commodity",commodity:null,office:null,report:null,reportFromDate:new Date,reportToDate:new Date,period:null},e.reportMaxDate=new Date,e.getData=function(){console.log("filter:",e.filter),l()&&r.$broadcast("data.filter",e.filter)},e.clearFilter=function(){e.filter={commodity:null,office:null,report:null,reportFromDate:new Date,reportToDate:new Date,period:null},a(function(){i.find("select[chosen]").trigger("chosen:updated")})},o.all([t.getCommoditiesPromise(),t.getOfficesPromise(),t.getReportsPromise()]).then(function(o){console.log("Get all data success"),e.commodities=t.commodities,e.offices=t.offices,e.reports=t.reports,a(function(){i.find("select[chosen]").chosen({disable_search_threshold:5,search_contains:!0})},500,!1)}).catch(function(e){throw e})}}}]),app.directive("sectionResult",["$parse","DataFactory","$timeout","$rootScope",function(e,t,o,a){return{restrict:"E",replace:!0,templateUrl:"templateCache/section-result.tmpl.html",scope:{dataModel:"="},link:function(e,o,r){function i(e,t){var o=$($(e.currentTarget).data("target"));t?o.slideUp(300):o.slideDown(300)}function n(o){e.tableColumns=t.tableColumns,e.filterFields=_.filter(e.tableColumns,function(e){return e.name});var a=_.groupBy(o,"groupKey"),r=[];for(var i in a)r.push({tableColumns:angular.copy(e.tableColumns),key:i,records:a[i]});r=_.sortBy(r,"key"),e.groupRecords=r,e.filtering=!1}e.toggleHeading=function(t){e.collapse=!e.collapse,i(t,e.collapse)},e.filterCollapse=!0,e.toggleHeadingFilter=function(t){e.filterCollapse=!e.filterCollapse,i(t,e.filterCollapse)},e.tableOptions={pageSize:10,pageIndex:0,showPageSize:!0,searching:!0,info:!0,paging:!0,ordering:!0,isAddControlColumn:!0},e.resultFilter={},e.toggleCollapseGroup=function(e){e.collapsed=!e.collapsed},e.toggleCollapseAll=function(){e.collapsed=!e.collapsed,_.forEach(e.groupRecords,function(t){t.collapsed=e.collapsed})},e.$on("data.filter",function(o,a){e.filtering=!0,a.commodity?t.getCommodityDataPromise(a.commodity).then(function(e){console.log("commodityData",e),n(e)}):a.office?t.getOfficeDataPromise(a.office).then(function(e){console.log("officeData",e),n(e)}):a.report?t.getReportDataPromise(a.report).then(function(e){console.log("reportData",e),n(e)}):(e.filtering=!1,e.tableColumns=[],e.groupRecords=[])}),e.filterData=function(){var t=[];for(var o in e.resultFilter)e.resultFilter[o]&&t.push({attrId:o,searchValue:e.resultFilter[o]});a.$broadcast("datagrid.search",t)},e.resetFilterData=function(){e.resultFilter={},a.$broadcast("datagrid.search",[])}}}}]),app.factory("BaseFactory",["$http",function(e){return{getRequest:function(e,t,o,a,r){return this.request("GET",e,null,t,o,a,r)},postRequest:function(e,t,o,a,r,i){return this.request("POST",e,t,o,a,r,i)},request:function(t,o,a,r,i,n,l){return e({method:t,url:o,data:a,headers:n,hideLoading:l}).success(function(e,t,o,a){403==t?alert("session expired"):r&&r(e,t,o)}).error(function(e,t,o,a){i&&i(e,t,o)})},baseRequestUrl:function(){return"api/"}}}]),app.factory("CommonFactory",["BaseFactory","$q",function(e,t){var o={};return o.generateUUID=function(){var e=(new Date).getTime()+Math.floor(1e3*Math.random()+1);return Math.seedrandom(e.toLocaleString()),"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?o:3&o|8).toString(16)})},String.prototype.replaceAll=function(e,t){var o=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a=new RegExp(o,"ig");return this.replace(a,t)},o.getRecursiveCompileFn=function(e){return function(t,o,a){var r,i=t.contents().remove();return function(t,o,n){r||(r=e(i,a)),r(t,function(e,t){o.append(e)})}}},o.applyDiff=function(e,t){angular.merge(e,t);var o={data:e},a={data:t};DeepDiff.applyDiff(o,a)},"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),o.showMessage=function(e,t,o){$.messager.show({title:e,msg:t,timeout:6e3}).parent().addClass("panel-custom")},o.showMessage4Ever=function(e,t){$.messager.show({title:e,msg:t,timeout:0}).parent().addClass("panel-custom panel-4ever")},o.hide4EverMessage=function(){$(".panel-4ever").find("a.panel-tool-close").click()},o.showAlert=function(e,t){$.messager.alert(e,t).parent().addClass("panel-custom")},o.replaceAllByText=function(e,t){return e&&""!=e?e.split(t).join(" "):e},o}]),app.factory("DataFactory",["CommonFactory","BaseFactory","$http","$q",function(e,t,o,a){function r(e,o){var r=a.defer(),l=s+e+"/"+o;return t.getRequest(l,function(e,t,o,a){var l=e.results;n(l),i(l),r.resolve(l)},function(e,t,o,a){r.reject([e,t,o,a])}),r.promise}function i(t){var o=[],a=e.generateUUID();t&&t.length&&_.forEach(t,function(t){for(;o.indexOf(a)>=0;)a=e.generateUUID();t.id=a,o.push(a),t.groupKey=t.group+" / "+t.category+" / "+t.commodity})}function n(e){var t=[{attrId:"column-controlled-child-rows",name:""}];if(e&&e.length)for(var o in e[0]){var a=l(o);d.indexOf(a)<0&&p.indexOf(a)<0&&t.push({attrId:o,name:a})}c.tableColumns=t}function l(e){return e.replaceAll("_"," ").split(" ").map(_.capitalize).join(" ")}var c={},s="http://10.80.9.9/services/v1/",d=["Office Name","Office Code","Office City","Office State","Market Location Name","Market Location City","Market Location State","Market Type","Market Type Category"],p=["Group","Category","Commodity"];return c.getCommoditiesPromise=function(){var e=a.defer(),o=s+"commodities";return c[o]?(c.commodities=angular.copy(c[commodities]),e.resolve([c.commodities])):t.getRequest(o,function(t,a,r,i){c.commodities=t,c[o]=angular.copy(t),e.resolve([t,a,r,i])},function(t,o,a,r){e.reject([t,o,a,r])}),e.promise},c.getOfficesPromise=function(){var e=a.defer(),o=s+"offices";return c[o]?(c.offices=angular.copy(c[offices]),e.resolve([c.offices])):t.getRequest(o,function(t,a,r,i){c.offices=t,c[o]=angular.copy(t),e.resolve([t,a,r,i])},function(t,o,a,r){e.reject([t,o,a,r])}),e.promise},c.getReportsPromise=function(){var e=a.defer(),o=s+"reports";return c[o]?(c.reports=angular.copy(c[reports]),e.resolve([c.reports])):t.getRequest(o,function(t,a,r,i){c.reports=t,c[o]=angular.copy(t),e.resolve([t,a,r,i])},function(t,o,a,r){e.reject([t,o,a,r])}),e.promise},c.getCommodityDataPromise=function(e){return r("commodities",e)},c.getOfficeDataPromise=function(e){return r("offices",e)},c.getReportDataPromise=function(e){return r("reports",e)},c}]);